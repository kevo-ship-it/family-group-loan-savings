<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FGLS Banking - Login</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-light">
  <div class="container py-5">
    <h2 class="text-center mb-4">FGLS Banking</h2>

    <div id="alert" class="alert" style="display: none;"></div>

    <!-- Sign In Form -->
    <div id="signin-form">
      <h4>Sign In</h4>
      <form>
        <input type="email" id="email" class="form-control mb-2" placeholder="Email" required />
        <input type="password" id="password" class="form-control mb-2" placeholder="Password" required />
        <button type="submit" class="btn btn-primary w-100">Sign In</button>
      </form>
      <p class="mt-2 text-end">
        <a href="#" id="show-forgot">Forgot password?</a> | 
        <a href="#" id="show-signup">Sign Up</a>
      </p>
    </div>

    <!-- Sign Up Form -->
    <div id="signup-form" style="display: none;">
      <h4>Sign Up</h4>
      <form>
        <input type="email" id="reg-email" class="form-control mb-2" placeholder="Email" required />
        <input type="password" id="reg-password" class="form-control mb-2" placeholder="Password" required />
        <input type="text" id="full-name" class="form-control mb-2" placeholder="Full Name" required />
        <button type="submit" class="btn btn-success w-100">Create Account</button>
      </form>
      <p class="mt-2 text-end"><a href="#" id="show-signin">Back to Sign In</a></p>
    </div>

    <!-- Forgot Password Form -->
    <div id="forgot-form" style="display: none;">
      <h4>Reset Password</h4>
      <form>
        <input type="email" id="reset-email" class="form-control mb-2" placeholder="Email" required />
        <button type="submit" class="btn btn-warning w-100">Send Reset Link</button>
      </form>
      <p class="mt-2 text-end"><a href="#" id="show-signin2">Back to Sign In</a></p>
    </div>
  </div>

  <script>
    const supabase = supabase.createClient(
      'https://idwqayipyhsvdxmtalli.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlkd3FheWlweWhzdmR4bXRhbGxpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY5NDIyMDgsImV4cCI6MjA2MjUxODIwOH0.zA-xAQK71EV843i1uGhA2MM2ooxrIG2F_qM5xT-iuYI'
    );

    const alertBox = document.getElementById('alert');
    const showAlert = (msg, type='info') => {
      alertBox.className = 'alert alert-' + type;
      alertBox.textContent = msg;
      alertBox.style.display = 'block';
      setTimeout(() => alertBox.style.display = 'none', 4000);
    };

    // Switch between forms
    document.getElementById('show-signup').onclick = () => {
      document.getElementById('signin-form').style.display = 'none';
      document.getElementById('signup-form').style.display = 'block';
    };
    document.getElementById('show-signin').onclick = () => {
      document.getElementById('signup-form').style.display = 'none';
      document.getElementById('signin-form').style.display = 'block';
    };
    document.getElementById('show-signin2').onclick = () => {
      document.getElementById('forgot-form').style.display = 'none';
      document.getElementById('signin-form').style.display = 'block';
    };
    document.getElementById('show-forgot').onclick = () => {
      document.getElementById('signin-form').style.display = 'none';
      document.getElementById('forgot-form').style.display = 'block';
    };

    // Sign In
    document.querySelector('#signin-form form').onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      const { data, error } = await supabase.auth.signInWithPassword({ email, password });

      if (error) return showAlert(error.message, 'danger');

      showAlert('Login successful!', 'success');
      setTimeout(() => window.location.href = 'dashboard.html', 1500);
    };

    // Sign Up
    document.querySelector('#signup-form form').onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('reg-email').value;
      const password = document.getElementById('reg-password').value;
      const full_name = document.getElementById('full-name').value;

      const { data, error } = await supabase.auth.signUp({
        email,
        password,
        options: {
          data: { full_name }
        }
      });

      if (error) return showAlert(error.message, 'danger');

      showAlert('Signup successful! Check your email to confirm.', 'success');
    };

    // Forgot Password
    document.querySelector('#forgot-form form').onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('reset-email').value;

      const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo: window.location.origin + '/reset-password.html'
      });

      if (error) return showAlert(error.message, 'danger');

      showAlert('Reset link sent to your email.', 'success');
    };
  </script>
</body>
  </html>
  
